(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{Jweo:function(e,t,n){"use strict";n.r(t),n.d(t,"ContentModule",(function(){return Ke}));var o=n("ofXK"),i=function(e){return e.TypeScript="TypeScript",e.Java="Java",e.Angular="Angular",e.React="React",e.JavaScript="JavaScript",e.CSharp="C#",e.NodeJS="Node JS",e.PHP="PHP",e.VisualForce="VisualForce",e.Aura="Aura Components",e.Apex="Apex",e.LWC="LWC",e.Firebase="Firebase",e.MongoDB="Mongo DB",e.HTML5="HTML 5",e.CSS3="CSS3",e.Salesforce="Salesforce",e}({});function r(){return Object.keys(i).map(e=>i[e]).sort()}class s{constructor(e){this._snackBar=e}showMsg(e,t="Success"){this._snackBar.open(e,t,{duration:7e3,horizontalPosition:"center",verticalPosition:"top"})}}var a=n("3Pt+"),c=n("fXoL"),l=n("3NCR"),u=n("tyNb"),d=n("mrSG"),b=n("Cfvw"),m=n("HDdC"),h=n("itXk"),p=n("bOdf"),f=n("7o/Q");class g{constructor(e,t){this.bufferSize=e,this.startBufferEvery=t,this.subscriberClass=t&&e!==t?S:C}call(e,t){return t.subscribe(new this.subscriberClass(e,this.bufferSize,this.startBufferEvery))}}class C extends f.a{constructor(e,t){super(e),this.bufferSize=t,this.buffer=[]}_next(e){const t=this.buffer;t.push(e),t.length==this.bufferSize&&(this.destination.next(t),this.buffer=[])}_complete(){const e=this.buffer;e.length>0&&this.destination.next(e),super._complete()}}class S extends f.a{constructor(e,t,n){super(e),this.bufferSize=t,this.startBufferEvery=n,this.buffers=[],this.count=0}_next(e){const{bufferSize:t,startBufferEvery:n,buffers:o,count:i}=this;this.count++,i%n==0&&o.push([]);for(let r=o.length;r--;){const n=o[r];n.push(e),n.length===t&&(o.splice(r,1),this.destination.next(n))}}_complete(){const{buffers:e,destination:t}=this;for(;e.length>0;){let n=e.shift();n.length>0&&t.next(n)}super._complete()}}var w=n("vkgz"),v=n("eIep"),T=n("lJxs"),O=n("I/3d");let M=(()=>{class e{constructor(e,t){this.db=e,this.auth=t,this.questionCollection=this.db.collection("questions")}deleteCollection(e){return Object(d.a)(this,void 0,void 0,(function*(){let t=0;return new Promise((n,o)=>Object(b.a)(this.db.collection(e).ref.get()).pipe(Object(p.a)(e=>Object(b.a)(e.docs)),function(e,t=null){return function(n){return n.lift(new g(e,t))}}(500),Object(p.a)(e=>new m.a(t=>{const n=this.db.firestore.batch();e.forEach(e=>n.delete(e.ref)),n.commit().then(()=>{t.next(e.length),t.complete()}).catch(e=>t.error(e))}))).subscribe(e=>t+=e,e=>{console.log(e),o(e)},()=>n(t)))}))}deleteQuestion(e){return Object(b.a)(this.deleteCollection(`questions/${e}/comments`)).pipe(Object(w.a)(e=>console.log("RES",e)),Object(v.a)(t=>Object(b.a)(this.db.doc(`questions/${e}`).delete())))}updateQuestion(e){return Object(b.a)(this.db.doc(`questions/${e.uid}`).update(e))}addQuestion(e){return Object(d.a)(this,void 0,void 0,(function*(){try{let t=yield this.questionCollection.add(e);return e.uid=t.id,e}catch(t){throw new Error(t)}}))}getQuestionById(e){return this.db.doc(`questions/${e}`).valueChanges()}getQuestions(){return this.auth.checkUser().pipe(Object(v.a)(e=>{if(e.roles.guest){const t=this.transformData(this.db.collection("questions",e=>e.where("onModeration","==",!1)).snapshotChanges()),n=this.transformData(this.db.collection("questions",t=>t.where("author.authorId","==",e.uid)).snapshotChanges());return Object(h.a)(t,n).pipe(Object(T.a)(e=>e.reduce((e,t)=>e.concat(t))))}return this.transformData(this.db.collection("questions").snapshotChanges())}))}transformData(e){return e.pipe(Object(T.a)(e=>e.map(e=>{let t=e.payload.doc.data();return Object.assign({uid:e.payload.doc.id},t)})))}}return e.\u0275fac=function(t){return new(t||e)(c.Xb(O.a),c.Xb(l.a))},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac}),e})();var x=n("7EHt"),y=n("QibW"),q=n("kmnG"),k=n("d3UM"),P=n("FKr1"),I=n("bSwM"),_=n("bTqV"),A=n("NFeN"),U=n("f0Cb"),D=n("1jcm"),N=n("qFsG"),R=n("A5z7");let j=(()=>{class e{constructor(e){this.authService=e}transform(e,t,n,o,i,r){if(!(t||n||o||i||r))return e;let s=e;return s=this.filterQuestionsByResolve(s,t),s=this.filterQuestionByCategory(s,n),s=this.filterQuestionByDate(s,o),s=this.filterQuestionsByAdminApprove(s,i),s=this.filterMyQuestions(s,r),0===s.length?[-1]:s}filterQuestionsByResolve(e,t){if(!t)return e;let n="true"===t;return e.filter(e=>e.isResolved===n)}filterQuestionByCategory(e,t){return t&&0!=t.length?e.filter(e=>e.categories.filter(e=>t.includes(e)).length>0?e:null):e}filterQuestionByDate(e,t){if(!t)return e;let n=new Date,o=new Date(n.getFullYear(),n.getMonth(),n.getDate()),i=[];return"day"===t?i=e.filter(e=>{let t=new Date(1e3*e.date.seconds);return new Date(t.getFullYear(),t.getMonth(),t.getDate()).valueOf()===o.valueOf()}):"week"===t?i=e.filter(e=>{let t=new Date(1e3*e.date.seconds),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=new Date(o.getTime()-5184e5);return n.valueOf()>=i.valueOf()}):"month"===t&&(i=e.filter(e=>{let t=new Date(1e3*e.date.seconds),n=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n.getMonth()==o.getMonth()&&n.getFullYear()==o.getFullYear()})),i}filterQuestionsByAdminApprove(e,t){return t?e.filter(e=>e.onModeration===t):e}filterMyQuestions(e,t){if(!t)return e;let n=JSON.parse(this.authService.sessionData);return e.filter(e=>e.author.authorId===n.uid)}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(l.a))},e.\u0275pipe=c.Nb({name:"filterQuestions",type:e,pure:!0}),e})(),F=(()=>{class e{transform(e,t){let n=!0===t?1:-1;return e.sort((e,t)=>{let o=new Date(1e3*e.date.seconds),i=new Date(1e3*t.date.seconds);return(Number(o)-Number(i))*n})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Nb({name:"sortQuestions",type:e,pure:!0}),e})();function $(e,t){if(1&e&&(c.Tb(0,"mat-option",27),c.Cc(1),c.Sb()),2&e){const e=t.$implicit;c.mc("value",e),c.Cb(1),c.Dc(e)}}function B(e,t){1&e&&(c.Tb(0,"mat-checkbox",29),c.Cc(1,"On Moderation"),c.Sb())}function E(e,t){if(1&e&&(c.Tb(0,"div"),c.Ac(1,B,2,0,"mat-checkbox",28),c.Sb()),2&e){const e=t.ngIf;c.Cb(1),c.mc("ngIf",e.roles.admin)}}function L(e,t){1&e&&(c.Tb(0,"mat-icon",40),c.Cc(1,"check"),c.Sb())}function Q(e,t){1&e&&(c.Tb(0,"div",41),c.Tb(1,"mat-icon"),c.Cc(2,"edit"),c.Sb(),c.Tb(3,"span"),c.Cc(4,"On Moderation"),c.Sb(),c.Sb())}function G(e,t){if(1&e&&(c.Tb(0,"mat-chip"),c.Cc(1),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.Dc(e)}}function z(e,t){1&e&&(c.Tb(0,"button",45),c.Cc(1,"Approve"),c.Sb())}function J(e,t){if(1&e&&(c.Tb(0,"div",42),c.Ac(1,z,2,0,"button",43),c.Tb(2,"button",44),c.Cc(3,"Delete"),c.Sb(),c.Sb()),2&e){const e=c.fc(2).$implicit;c.Cb(1),c.mc("ngIf",e.onModeration)}}function Y(e,t){if(1&e&&(c.Tb(0,"div"),c.Tb(1,"h1"),c.Cc(2),c.Sb(),c.Tb(3,"div",34),c.Ac(4,L,2,0,"mat-icon",35),c.Ac(5,Q,5,0,"div",36),c.Sb(),c.Tb(6,"div",37),c.Tb(7,"em"),c.Cc(8),c.gc(9,"date"),c.Sb(),c.Sb(),c.Tb(10,"mat-chip-list"),c.Ac(11,G,2,1,"mat-chip",38),c.Sb(),c.Ac(12,J,4,1,"div",39),c.Sb()),2&e){const e=c.fc().$implicit,t=c.fc().ngIf;c.Cb(2),c.Dc(e.title),c.Cb(2),c.mc("ngIf",e.isResolved),c.Cb(1),c.mc("ngIf",e.onModeration),c.Cb(3),c.Dc(c.ic(9,6,1e3*e.date.seconds,"dd-MM-yyyy h:mm")),c.Cb(3),c.mc("ngForOf",e.categories),c.Cb(1),c.mc("ngIf",t.roles.admin)}}function K(e,t){if(1&e){const e=c.Ub();c.Tb(0,"div",32),c.bc("click",(function(){c.tc(e);const n=t.$implicit,o=c.fc().ngIf;return c.fc().handleNavigate(n.uid,o)})),c.Ac(1,Y,13,9,"div",33),c.Sb()}if(2&e){const e=t.$implicit,n=c.fc(2),o=c.sc(59);c.Fb("filterBlock",-1===e),c.mc("ngClass",n.displayAsCards?"question":"question-row"),c.Cb(1),c.mc("ngIf",-1!==e)("ngIfElse",o)}}const V=function(e,t,n,o,i,r){return[e,t,n,o,i,r]};function X(e,t){if(1&e&&(c.Tb(0,"div",30),c.Ac(1,K,2,5,"div",31),c.gc(2,"filterQuestions"),c.gc(3,"sortQuestions"),c.Sb()),2&e){const e=c.fc();c.Cb(1),c.mc("ngForOf",c.jc(2,1,c.qc(11,V,c.ic(3,8,e.questionsList,e.sortDirection),e.form.get("questionResolveGroup").value,e.form.get("questionCategoryGroup").value,e.form.get("questionDateGroup").value,e.form.get("questionApproveGroup").value,e.form.get("questionMineGroup").value)))}}function H(e,t){1&e&&(c.Tb(0,"h1"),c.Cc(1,"Loading data ..."),c.Sb())}function W(e,t){1&e&&(c.Tb(0,"h1",46),c.Cc(1,"Nothing to show!"),c.Sb())}let Z=(()=>{class e{constructor(e,t,n,o){this.authFB=e,this.router=t,this.questionService=n,this.render=o,this.questionsList=[],this.categoryList=r(),this.displayAsCards=!0,this.sortDirection=!0,this.appColor="#FFFFFF"}ngOnInit(){this.user$=this.authFB.checkUser(),this.queSerSub=this.questionService.getQuestions().subscribe(e=>{let t=new Set;e.forEach(e=>t.add(JSON.stringify(e)));let n=[];t.forEach(e=>n.push(JSON.parse(e))),this.questionsList=[...n],console.log(this.questionsList)}),this.form=new a.e({questionResolveGroup:new a.c(null),questionCategoryGroup:new a.c(null),questionDateGroup:new a.c(null),questionApproveGroup:new a.c(null),questionMineGroup:new a.c(null)})}handleAddClick(){this.router.navigate(["content","questions","create"])}handleSortBtnClick(){this.sortDirection=!this.sortDirection}resetFilters(){this.form.reset()}handleNavigate(e,t){this.questionsList.find(t=>t.uid===e),this.router.navigate(["content","question",e])}ngOnDestroy(){this.queSerSub&&this.queSerSub.unsubscribe()}handleChangeAppColor(){this.render.setStyle(document.body,"background-color",this.appColor)}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(l.a),c.Ob(u.b),c.Ob(M),c.Ob(c.E))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-question-page"]],decls:63,vars:13,consts:[[1,"toolbar"],["for","settings-wrapper-id"],["id","settings-wrapper-id",1,"settings-wrapper",3,"formGroup"],[1,"settings-item"],["id","resolved-filter"],["formControlName","questionResolveGroup","aria-labelledby","resolved-filter",1,"resolve-group"],["value","true",1,"resolve-group-btn"],["value","false",1,"resolve-group-btn"],["formControlName","questionCategoryGroup","multiple",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","questionDateGroup"],["value","day"],["value","week"],["value","month"],["formControlName","questionMineGroup"],[4,"ngIf"],["mat-icon-button","","color","primary","aria-label","sort direction",3,"click"],["mat-flat-button","",1,"reset-btn",3,"click"],["for","view-settings"],["id","view-settings",1,"question-settings-wrapper"],[3,"ngModel","ngModelChange"],["appearance","outline",1,"color-control"],["type","color","matInput","",3,"ngModel","ngModelChange","change"],["class","questions-wrapper",4,"ngIf","ngIfElse"],["loadingBlock",""],["filterBlock",""],["mat-fab","","color","accent","aria-label","Add question button",1,"plus-btn",3,"click"],[3,"value"],["formControlName","questionApproveGroup",4,"ngIf"],["formControlName","questionApproveGroup"],[1,"questions-wrapper"],[3,"filterBlock","ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[4,"ngIf","ngIfElse"],[1,"icons-wrapper"],["color","primary",4,"ngIf"],["class","on-moderation-wrapper",4,"ngIf"],[1,"date-wrapper"],[4,"ngFor","ngForOf"],["class","admin-controls",4,"ngIf"],["color","primary"],[1,"on-moderation-wrapper"],[1,"admin-controls"],["mat-flat-button","","color","accent",4,"ngIf"],["mat-flat-button","","color","warn"],["mat-flat-button","","color","accent"],[1,"nothing-to-show-header"]],template:function(e,t){if(1&e&&(c.Tb(0,"div",0),c.Tb(1,"mat-accordion"),c.Tb(2,"mat-expansion-panel"),c.Tb(3,"mat-expansion-panel-header"),c.Tb(4,"mat-panel-title"),c.Cc(5," Settings "),c.Sb(),c.Sb(),c.Tb(6,"label",1),c.Cc(7,"Filters and Sort"),c.Sb(),c.Tb(8,"div",2),c.Tb(9,"div",3),c.Tb(10,"label",4),c.Cc(11,"Resolved/unresolved questions"),c.Sb(),c.Tb(12,"mat-radio-group",5),c.Tb(13,"mat-radio-button",6),c.Cc(14," Resolved "),c.Sb(),c.Tb(15,"mat-radio-button",7),c.Cc(16," Unresolved "),c.Sb(),c.Sb(),c.Sb(),c.Tb(17,"div",3),c.Tb(18,"mat-form-field"),c.Tb(19,"mat-label"),c.Cc(20,"Categories"),c.Sb(),c.Tb(21,"mat-select",8),c.Ac(22,$,2,2,"mat-option",9),c.Sb(),c.Sb(),c.Sb(),c.Tb(23,"div",3),c.Tb(24,"mat-form-field"),c.Tb(25,"mat-label"),c.Cc(26,"Filter by date"),c.Sb(),c.Tb(27,"mat-select",10),c.Tb(28,"mat-option",11),c.Cc(29,"Day"),c.Sb(),c.Tb(30,"mat-option",12),c.Cc(31,"Week"),c.Sb(),c.Tb(32,"mat-option",13),c.Cc(33,"Month"),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Tb(34,"mat-checkbox",14),c.Cc(35,"My questions"),c.Sb(),c.Ac(36,E,2,1,"div",15),c.gc(37,"async"),c.Tb(38,"button",16),c.bc("click",(function(){return t.handleSortBtnClick()})),c.Tb(39,"mat-icon"),c.Cc(40),c.Sb(),c.Sb(),c.Tb(41,"button",17),c.bc("click",(function(){return t.resetFilters()})),c.Tb(42,"mat-icon"),c.Cc(43,"close"),c.Sb(),c.Sb(),c.Sb(),c.Pb(44,"mat-divider"),c.Tb(45,"label",18),c.Cc(46,"Questions view settings"),c.Sb(),c.Tb(47,"div",19),c.Tb(48,"mat-slide-toggle",20),c.bc("ngModelChange",(function(e){return t.displayAsCards=e})),c.Cc(49),c.Sb(),c.Tb(50,"mat-form-field",21),c.Tb(51,"mat-label"),c.Cc(52,"Application Color"),c.Sb(),c.Tb(53,"input",22),c.bc("ngModelChange",(function(e){return t.appColor=e}))("change",(function(){return t.handleChangeAppColor()})),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Ac(54,X,4,18,"div",23),c.gc(55,"async"),c.Ac(56,H,2,0,"ng-template",null,24,c.Bc),c.Ac(58,W,2,0,"ng-template",null,25,c.Bc),c.Tb(60,"button",26),c.bc("click",(function(){return t.handleAddClick()})),c.Tb(61,"mat-icon"),c.Cc(62,"add"),c.Sb(),c.Sb()),2&e){const e=c.sc(57);c.Cb(8),c.mc("formGroup",t.form),c.Cb(14),c.mc("ngForOf",t.categoryList),c.Cb(14),c.mc("ngIf",c.hc(37,9,t.user$)),c.Cb(4),c.Dc(t.sortDirection?"arrow_downward":"arrow_upward"),c.Cb(8),c.mc("ngModel",t.displayAsCards),c.Cb(1),c.Dc(t.displayAsCards?"Display as tile":"Display as row"),c.Cb(4),c.mc("ngModel",t.appColor),c.Cb(1),c.mc("ngIf",c.hc(55,11,t.questionsList.length>0&&t.user$))("ngIfElse",e)}},directives:[x.a,x.c,x.e,x.f,a.l,a.f,y.b,a.k,a.d,y.a,q.c,q.f,k.a,o.k,P.i,I.a,o.l,_.a,A.a,U.a,D.a,a.n,N.a,a.b,o.j,R.b,R.a],pipes:[o.b,j,F,o.e],styles:["[_nghost-%COMP%]{width:100%}.filterBlock[_ngcontent-%COMP%]{flex:0 0 100%!important;max-width:none!important;box-shadow:none!important;border:none!important;text-align:center}.nothing-to-show-header[_ngcontent-%COMP%]{color:#dc0f0c}.plus-btn[_ngcontent-%COMP%]{position:fixed;bottom:0;right:0;transform:translate(-10%,-50%)}.toolbar[_ngcontent-%COMP%]{margin-bottom:3rem}.settings-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;border:1px dashed grey;padding:1rem}.resolve-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;justify-content:center}mat-divider[_ngcontent-%COMP%]{margin:1rem 0}.question-settings-wrapper[_ngcontent-%COMP%]{width:100%;padding:1rem;border:1px dashed grey;align-items:center}.question-settings-wrapper[_ngcontent-%COMP%], .questions-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap}.questions-wrapper[_ngcontent-%COMP%]{align-items:flex-start}.question[_ngcontent-%COMP%]{padding:1.5rem 1rem;flex:0 0 calc(33% - 2rem);max-width:300px;min-height:300px;margin-bottom:2rem;background:#fff}.question[_ngcontent-%COMP%], .question-row[_ngcontent-%COMP%]{box-shadow:0 4px 8px 0 rgba(0,0,0,.2);transition:.3s}.question-row[_ngcontent-%COMP%]{max-width:none;flex:0 0 100%;margin-bottom:1rem;text-align:center}.question-row[_ngcontent-%COMP%]   mat-chip-list[_ngcontent-%COMP%]{display:inline-block;text-align:center}.question[_ngcontent-%COMP%], .question-row[_ngcontent-%COMP%]:hover{cursor:pointer;box-shadow:0 8px 16px 0 rgba(0,0,0,.2)}.question[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}mat-icon[_ngcontent-%COMP%]{font-size:36px;width:36px;height:36px}.date-wrapper[_ngcontent-%COMP%], .icons-wrapper[_ngcontent-%COMP%]{text-align:center}.icons-wrapper[_ngcontent-%COMP%]{margin-bottom:1rem}.on-moderation-wrapper[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column;align-items:center;justify-content:center}.admin-controls[_ngcontent-%COMP%]{margin-top:1.5rem;text-align:center}.admin-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block;margin-right:2px}@media screen and (max-width:768px){.question[_ngcontent-%COMP%]{flex:0 0 100%}.color-control[_ngcontent-%COMP%]{width:100%;margin-top:1rem}}"]}),e})();var ee=n("PCNd"),te=n("dNgK"),ne=n("cyVl");function oe(e,t){1&e&&(c.Tb(0,"mat-error"),c.Tb(1,"em"),c.Cc(2,"Please enter question title!"),c.Sb(),c.Sb())}function ie(e,t){if(1&e&&(c.Tb(0,"mat-option",12),c.Cc(1),c.Sb()),2&e){const e=t.$implicit;c.mc("value",e),c.Cb(1),c.Dc(e)}}function re(e,t){1&e&&(c.Tb(0,"mat-error"),c.Tb(1,"em"),c.Cc(2,"Please choose some categories!"),c.Sb(),c.Sb())}function se(e,t){1&e&&(c.Tb(0,"mat-error"),c.Tb(1,"em"),c.Cc(2,"Please enter your question!"),c.Sb(),c.Sb())}const ae=["*"];let ce=(()=>{class e{constructor(e,t,n,o){this.router=e,this.questionService=t,this._snackBar=n,this.spinnerService=o,this.categoryList=r(),this.disableBtn=!1,this.showUserMsg=new s(this._snackBar)}ngOnInit(){this.form=new a.e({title:new a.c(null,[a.q.required]),categories:new a.c(null,[a.q.required]),text:new a.c(null,[a.q.required])})}handleCancel(){this.router.navigate(["content","questions"])}handleAdd(){if(this.form.invalid)return null;let e=JSON.parse(localStorage.getItem("user")),t={author:{authorId:e.uid,authorName:e.displayName||e.email,authorPhoto:e.photoURL||"https://cdn3.vectorstock.com/i/1000x1000/05/37/error-message-skull-vector-3320537.jpg"},title:this.form.value.title,text:this.form.value.text,categories:this.form.value.categories,date:new Date,onModeration:!0,isResolved:!1};this.disableBtn=!0,this.spinnerService.showSpinner(),this.questionService.addQuestion(t).then(e=>{this.showUserMsg.showMsg(`Your question: "${e.title}" is accepted. After the administrator checks your question, it will be visible to other users.`)}).catch(e=>{this.showUserMsg.showMsg(e.message,"Error")}).finally(()=>{this.form.reset({categories:"",title:"",text:""}),this.disableBtn=!1,this.spinnerService.hideSpinner()})}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(u.b),c.Ob(M),c.Ob(te.a),c.Ob(ne.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-create-question-page"]],ngContentSelectors:ae,decls:26,vars:9,consts:[[1,"component-wrapper"],[3,"formGroup"],["appearance","fill"],["matInput","","formControlName","title","name","title"],[4,"ngIf"],["appearance","standard"],["multiple","","formControlName","categories"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","text",3,"matTextareaAutosize","cdkAutosizeMinRows"],[1,"btn-wrapper"],["mat-flat-button","","color","accent",3,"disabled","click"],["mat-flat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&(c.lc(),c.Tb(0,"div",0),c.Tb(1,"h1"),c.Cc(2,"New question"),c.Sb(),c.Tb(3,"form",1),c.Tb(4,"mat-form-field",2),c.Tb(5,"mat-label"),c.Cc(6,"tittle"),c.Sb(),c.Pb(7,"input",3),c.Ac(8,oe,3,0,"mat-error",4),c.Sb(),c.Tb(9,"mat-form-field",5),c.Tb(10,"mat-label"),c.Cc(11,"Categories"),c.Sb(),c.Tb(12,"mat-select",6),c.Ac(13,ie,2,2,"mat-option",7),c.Sb(),c.Ac(14,re,3,0,"mat-error",4),c.Sb(),c.Tb(15,"mat-form-field",2),c.Tb(16,"mat-label"),c.Cc(17,"Text"),c.Sb(),c.Pb(18,"textarea",8),c.Ac(19,se,3,0,"mat-error",4),c.Sb(),c.Sb(),c.Tb(20,"div",9),c.Tb(21,"button",10),c.bc("click",(function(){return t.handleCancel()})),c.Cc(22,"Cancel"),c.Sb(),c.Tb(23,"button",11),c.bc("click",(function(){return t.handleAdd()})),c.Cc(24,"Add"),c.Sb(),c.Sb(),c.Sb(),c.kc(25)),2&e&&(c.Cb(3),c.mc("formGroup",t.form),c.Cb(5),c.mc("ngIf",t.form.get("title").hasError("required")),c.Cb(5),c.mc("ngForOf",t.categoryList),c.Cb(1),c.mc("ngIf",t.form.get("categories").hasError("required")),c.Cb(4),c.mc("matTextareaAutosize",!0)("cdkAutosizeMinRows",10),c.Cb(1),c.mc("ngIf",t.form.get("text").hasError("required")),c.Cb(2),c.mc("disabled",t.disableBtn),c.Cb(2),c.mc("disabled",t.form.invalid||t.disableBtn))},directives:[a.r,a.l,a.f,q.c,q.f,N.a,a.b,a.k,a.d,o.l,k.a,o.k,N.c,_.a,q.b,P.i],styles:["[_nghost-%COMP%]{width:85%;margin:2rem auto 0;padding:1rem 3rem;border:1px solid var(--dark-color)}.component-wrapper[_ngcontent-%COMP%]{width:80%;margin:0 auto;display:flex;flex-direction:column}h1[_ngcontent-%COMP%]{text-align:center;text-transform:capitalize;padding-bottom:1rem;margin-bottom:2rem;border-bottom:1px solid var(--dark-color)}form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.btn-wrapper[_ngcontent-%COMP%]{width:100%;text-align:right}.btn-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block;width:75px}@media screen and (max-width:768px){[_nghost-%COMP%]{padding:1rem}.component-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%]{width:100%}}"]}),e})();var le=n("VRyK"),ue=n("0IaG"),de=n("pLZG");let be=(()=>{class e{constructor(e){this.db=e}deleteComment(e){return Object(b.a)(this.db.doc(`questions/${e.questionId}/comments/${e.uid}`).delete())}updateComment(e){return Object(b.a)(this.db.doc(`questions/${e.questionId}/comments/${e.uid}`).update(e))}getCommentsForQuestion(e){return this.db.collection(`questions/${e}/comments`,e=>e.orderBy("date")).snapshotChanges().pipe(Object(T.a)(e=>e.map(e=>{const t=e.payload.doc.data();return Object.assign({uid:e.payload.doc.id},t)})))}getAnswerCommentForQuestion(e){return this.db.collection(`questions/${e}/comments`,e=>e.where("isSolution","==",!0).limit(1)).valueChanges().pipe(Object(de.a)(e=>0!==e.length),Object(T.a)(e=>e[0]))}addComment(e){return Object(d.a)(this,void 0,void 0,(function*(){try{let t=yield this.db.collection(`questions/${e.questionId}/comments`).add(e);return e.uid=t.id,e}catch(t){throw new Error(t)}}))}}return e.\u0275fac=function(t){return new(t||e)(c.Xb(O.a))},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac}),e})();function me(e,t){1&e&&(c.Tb(0,"mat-error"),c.Cc(1,"Please, enter some values!"),c.Sb())}let he=(()=>{class e{constructor(e,t,n,o,i){this.commentsService=e,this.dialogRef=t,this.spinnerService=n,this._snackBar=o,this.data=i,this.commentText="",this.showUserMsg=new s(this._snackBar)}ngOnInit(){}handleAddComment(){const e={author:{authorName:this.data.u.displayName||this.data.u.email,authorId:this.data.u.uid,authorPhoto:this.data.u.photoURL||"https://cdn3.vectorstock.com/i/1000x1000/05/37/error-message-skull-vector-3320537.jpg"},date:new Date,isSolution:!1,questionId:this.data.q.uid,text:this.commentText};this.spinnerService.showSpinner(),this.commentsService.addComment(e).then(e=>{this.showUserMsg.showMsg(`Thank you, ${e.author.authorName} for response!`)}).catch(e=>{this.showUserMsg.showMsg(e.message,"Error")}).finally(()=>{this.spinnerService.hideSpinner(),this.dialogRef.close()})}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(be),c.Ob(ue.g),c.Ob(ne.a),c.Ob(te.a),c.Ob(ue.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-add-comment-dialog"]],decls:13,vars:4,consts:[["mat-dialog-title",""],["appearance","outline","color","primary"],["matInput","","required","",3,"ngModel","ngModelChange"],[4,"ngIf"],["align","center"],["mat-flat-button","","mat-dialog-close","","color","accent"],["mat-flat-button","","color","primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.Tb(0,"h1",0),c.Cc(1),c.Sb(),c.Tb(2,"mat-dialog-content"),c.Tb(3,"mat-form-field",1),c.Tb(4,"mat-label"),c.Cc(5,"Your answer..."),c.Sb(),c.Tb(6,"textarea",2),c.bc("ngModelChange",(function(e){return t.commentText=e})),c.Sb(),c.Ac(7,me,2,0,"mat-error",3),c.Sb(),c.Sb(),c.Tb(8,"mat-dialog-actions",4),c.Tb(9,"button",5),c.Cc(10,"Close"),c.Sb(),c.Tb(11,"button",6),c.bc("click",(function(){return t.handleAddComment()})),c.Cc(12,"Add"),c.Sb(),c.Sb()),2&e&&(c.Cb(1),c.Ec('Add your solution to: "',t.data.q.title,'" question'),c.Cb(5),c.mc("ngModel",t.commentText),c.Cb(1),c.mc("ngIf",!t.commentText),c.Cb(4),c.mc("disabled",!t.commentText))},directives:[ue.h,ue.e,q.c,q.f,N.a,a.b,a.p,a.k,a.n,o.l,ue.c,_.a,ue.d,q.b],styles:["h1[_ngcontent-%COMP%]{font-weight:700;text-align:centerlo}mat-dialog-content[_ngcontent-%COMP%]{margin:1.5rem 0}mat-form-field[_ngcontent-%COMP%]{width:100%}@media screen and (max-width:768px){[_nghost-%COMP%]{width:100%}h1[_ngcontent-%COMP%]{font-size:16px}}"]}),e})();function pe(e,t){1&e&&(c.Tb(0,"mat-error"),c.Tb(1,"em"),c.Cc(2,"Please enter question title!"),c.Sb(),c.Sb())}function fe(e,t){if(1&e&&(c.Tb(0,"mat-option",13),c.Cc(1),c.Sb()),2&e){const e=t.$implicit;c.mc("value",e),c.Cb(1),c.Dc(e)}}function ge(e,t){1&e&&(c.Tb(0,"mat-error"),c.Tb(1,"em"),c.Cc(2,"Please choose some categories!"),c.Sb(),c.Sb())}function Ce(e,t){1&e&&(c.Tb(0,"mat-error"),c.Tb(1,"em"),c.Cc(2,"Please enter your question!"),c.Sb(),c.Sb())}function Se(e,t){1&e&&(c.Tb(0,"mat-checkbox",14),c.Cc(1,"Question Resolved"),c.Sb())}let we=(()=>{class e{constructor(e,t,n,o,i,a){this.questionService=e,this.commentsService=t,this.dialogRef=n,this.spinnerService=o,this._snackBar=i,this.data=a,this.categoryList=r(),this.showUserMsg=new s(this._snackBar)}ngOnInit(){this.form=new a.e({title:new a.c(this.data.q.title,[a.q.required]),categories:new a.c(this.data.q.categories,[a.q.required]),text:new a.c(this.data.q.text,[a.q.required]),isResolved:new a.c(this.data.q.isResolved)})}handleEditQuestion(){if(this.form.invalid)return null;let e={uid:this.data.q.uid,title:this.form.value.title,categories:this.form.value.categories,text:this.form.value.text,isResolved:this.form.value.isResolved,author:this.data.q.author,onModeration:this.data.q.onModeration,date:this.data.q.date};this.spinnerService.showSpinner(),this.updQSub=this.questionService.updateQuestion(e).subscribe(()=>{if(!e.isResolved){let t;this.updCSub=this.commentsService.getAnswerCommentForQuestion(e.uid).pipe(Object(v.a)(e=>(e.isSolution=!1,t=e,this.commentsService.updateComment(e)))).subscribe(()=>{this.showUserMsg.showMsg(`This comment: "${t.text.substr(0,25)} ..." is no longer an answer to your question`)},e=>{this.showUserMsg.showMsg(e.message,"Error")})}this.spinnerService.hideSpinner(),this.showUserMsg.showMsg(`Your question "${e.title}" was updated!`)},e=>{this.spinnerService.hideSpinner(),this.showUserMsg.showMsg(e.message,"Error"),this.dialogRef.close()},()=>{this.spinnerService.hideSpinner(),this.dialogRef.close()})}ngOnDestroy(){this.updQSub&&this.updQSub.unsubscribe(),this.updCSub&&this.updCSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(M),c.Ob(be),c.Ob(ue.g),c.Ob(ne.a),c.Ob(te.a),c.Ob(ue.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-edit-question-dialog"]],decls:26,vars:10,consts:[["mat-dialog-title",""],[3,"formGroup"],["appearance","fill"],["matInput","","formControlName","title","name","title"],[4,"ngIf"],["appearance","standard"],["multiple","","formControlName","categories"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","text",3,"matTextareaAutosize","cdkAutosizeMinRows"],["formControlName","isResolved","color","primary",4,"ngIf"],["align","center"],["mat-flat-button","","mat-dialog-close","","color","accent"],["mat-flat-button","","color","primary",3,"disabled","click"],[3,"value"],["formControlName","isResolved","color","primary"]],template:function(e,t){1&e&&(c.Tb(0,"h1",0),c.Cc(1),c.Sb(),c.Tb(2,"mat-dialog-content"),c.Tb(3,"form",1),c.Tb(4,"mat-form-field",2),c.Tb(5,"mat-label"),c.Cc(6,"tittle"),c.Sb(),c.Pb(7,"input",3),c.Ac(8,pe,3,0,"mat-error",4),c.Sb(),c.Tb(9,"mat-form-field",5),c.Tb(10,"mat-label"),c.Cc(11,"Categories"),c.Sb(),c.Tb(12,"mat-select",6),c.Ac(13,fe,2,2,"mat-option",7),c.Sb(),c.Ac(14,ge,3,0,"mat-error",4),c.Sb(),c.Tb(15,"mat-form-field",2),c.Tb(16,"mat-label"),c.Cc(17,"Text"),c.Sb(),c.Pb(18,"textarea",8),c.Ac(19,Ce,3,0,"mat-error",4),c.Sb(),c.Ac(20,Se,2,0,"mat-checkbox",9),c.Sb(),c.Sb(),c.Tb(21,"mat-dialog-actions",10),c.Tb(22,"button",11),c.Cc(23,"Close"),c.Sb(),c.Tb(24,"button",12),c.bc("click",(function(){return t.handleEditQuestion()})),c.Cc(25,"Add"),c.Sb(),c.Sb()),2&e&&(c.Cb(1),c.Ec('Edit: "',t.data.q.title,'" question'),c.Cb(2),c.mc("formGroup",t.form),c.Cb(5),c.mc("ngIf",t.form.get("title").hasError("required")),c.Cb(5),c.mc("ngForOf",t.categoryList),c.Cb(1),c.mc("ngIf",t.form.get("categories").hasError("required")),c.Cb(4),c.mc("matTextareaAutosize",!0)("cdkAutosizeMinRows",10),c.Cb(1),c.mc("ngIf",t.form.get("text").hasError("required")),c.Cb(1),c.mc("ngIf",t.data.q.isResolved),c.Cb(4),c.mc("disabled",t.form.invalid))},directives:[ue.h,ue.e,a.r,a.l,a.f,q.c,q.f,N.a,a.b,a.k,a.d,o.l,k.a,o.k,N.c,ue.c,_.a,ue.d,q.b,P.i,I.a],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}form[_ngcontent-%COMP%], mat-form-field[_ngcontent-%COMP%]{width:100%}input[_ngcontent-%COMP%]{padding:.5rem 0}textarea[_ngcontent-%COMP%]{min-height:100px}mat-checkbox[_ngcontent-%COMP%]{width:100%;padding-top:.5rem}mat-checkbox[_ngcontent-%COMP%]     .mat-checkbox-inner-container{width:32px;height:32px}"]}),e})();function ve(e,t){if(1&e&&(c.Tb(0,"mat-chip",10),c.Cc(1),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.Dc(e)}}function Te(e,t){if(1&e){const e=c.Ub();c.Tb(0,"button",16),c.bc("click",(function(){c.tc(e);const t=c.fc().ngIf,n=c.fc().ngIf;return c.fc().handleEditQuestion(n,t)})),c.Cc(1," Edit "),c.Sb()}}function Oe(e,t){if(1&e){const e=c.Ub();c.Tb(0,"button",12),c.bc("click",(function(){c.tc(e);const t=c.fc(2).ngIf,n=c.fc(),o=c.sc(3);return n.handleApprove(t,o)})),c.Cc(1," Approve "),c.Sb()}}function Me(e,t){if(1&e){const e=c.Ub();c.Tb(0,"button",17),c.bc("click",(function(){c.tc(e);const t=c.fc(2).ngIf,n=c.fc(),o=c.sc(3);return n.handleDelete(t,o)})),c.Cc(1," Delete "),c.Sb()}}function xe(e,t){if(1&e){const e=c.Ub();c.Tb(0,"div",11),c.Tb(1,"button",12),c.bc("click",(function(){c.tc(e);const n=t.ngIf,o=c.fc().ngIf;return c.fc().handleAddComment(o,n)})),c.Cc(2," Comment "),c.Sb(),c.Ac(3,Te,2,0,"button",13),c.Ac(4,Oe,2,0,"button",14),c.Ac(5,Me,2,0,"button",15),c.Sb()}if(2&e){const e=t.ngIf,n=c.fc().ngIf;c.Cb(3),c.mc("ngIf",e.uid===n.author.authorId),c.Cb(1),c.mc("ngIf",e.roles.admin&&n.onModeration),c.Cb(1),c.mc("ngIf",e.roles.admin)}}function ye(e,t){if(1&e){const e=c.Ub();c.Tb(0,"div"),c.Tb(1,"button",26),c.bc("click",(function(){c.tc(e);const t=c.fc().$implicit,n=c.fc(2).ngIf,o=c.fc(),i=c.sc(3);return o.handleCommentMark(t,n,i)})),c.Tb(2,"mat-icon"),c.Cc(3,"done_outline"),c.Sb(),c.Sb(),c.Sb()}}function qe(e,t){if(1&e){const e=c.Ub();c.Tb(0,"button",27),c.bc("click",(function(){c.tc(e);const t=c.fc().$implicit,n=c.fc(2).ngIf,o=c.fc(),i=c.sc(3);return o.handleDeleteComment(t,n,i)})),c.Cc(1,"Delete "),c.Sb()}}function ke(e,t){1&e&&(c.Tb(0,"div"),c.Tb(1,"mat-icon",28),c.Cc(2,"check"),c.Sb(),c.Sb())}function Pe(e,t){if(1&e&&(c.Tb(0,"div",20),c.Tb(1,"div",21),c.Pb(2,"img",22),c.Tb(3,"span"),c.Cc(4),c.Sb(),c.Sb(),c.Tb(5,"div",23),c.Tb(6,"p"),c.Cc(7),c.Sb(),c.Tb(8,"p"),c.Tb(9,"em"),c.Cc(10),c.gc(11,"date"),c.Sb(),c.Sb(),c.Sb(),c.Tb(12,"div",24),c.Ac(13,ye,4,0,"div",0),c.Tb(14,"div"),c.Ac(15,qe,2,0,"button",25),c.Sb(),c.Ac(16,ke,3,0,"div",0),c.Sb(),c.Sb()),2&e){const e=t.$implicit,n=c.fc(2).ngIf,o=c.fc();c.Cb(2),c.nc("src",e.author.authorPhoto,c.vc),c.nc("alt",e.author.authorName),c.Cb(2),c.Dc(e.author.authorName),c.Cb(3),c.Dc(e.text),c.Cb(3),c.Dc(c.ic(11,8,1e3*e.date.seconds,"dd:MM:yyyy hh:mm")),c.Cb(3),c.mc("ngIf",!n.isResolved&&n.author.authorId===o.authorId),c.Cb(2),c.mc("ngIf",o.mUser.roles.admin),c.Cb(1),c.mc("ngIf",e.isSolution)}}function Ie(e,t){if(1&e&&(c.Tb(0,"div",18),c.Tb(1,"h1"),c.Cc(2),c.Sb(),c.Ac(3,Pe,17,11,"div",19),c.Sb()),2&e){const e=t.ngIf;c.Cb(2),c.Dc(e.length>0?"Comments/Answers":"No comments"),c.Cb(1),c.mc("ngForOf",e)}}function _e(e,t){if(1&e&&(c.Tb(0,"div"),c.Tb(1,"div",3),c.Tb(2,"div",4),c.Tb(3,"h3"),c.Cc(4),c.Sb(),c.Tb(5,"h3"),c.Cc(6),c.gc(7,"date"),c.Sb(),c.Sb(),c.Tb(8,"h1"),c.Cc(9),c.Sb(),c.Tb(10,"p",5),c.Cc(11),c.Sb(),c.Tb(12,"div",6),c.Tb(13,"mat-chip-list"),c.Ac(14,ve,2,1,"mat-chip",7),c.Sb(),c.Ac(15,xe,6,3,"div",8),c.gc(16,"async"),c.Sb(),c.Sb(),c.Ac(17,Ie,4,2,"div",9),c.gc(18,"async"),c.Sb()),2&e){const e=t.ngIf,n=c.fc(),o=c.sc(5);c.Cb(4),c.Dc(e.author.authorName),c.Cb(2),c.Dc(c.ic(7,8,1e3*e.date.seconds,"dd-MM-yyyy , hh:mm")),c.Cb(3),c.Dc(e.title),c.Cb(2),c.Dc(e.text),c.Cb(3),c.mc("ngForOf",e.categories),c.Cb(1),c.mc("ngIf",c.hc(16,11,n.currentUser$)),c.Cb(2),c.mc("ngIf",c.hc(18,13,n.comments$))("ngIfElse",o)}}function Ae(e,t){if(1&e){const e=c.Ub();c.Tb(0,"h2",29),c.Cc(1),c.Sb(),c.Tb(2,"mat-dialog-content"),c.Tb(3,"p",30),c.Tb(4,"em"),c.Cc(5,"Author: "),c.Sb(),c.Cc(6),c.Sb(),c.Tb(7,"p",30),c.Tb(8,"em"),c.Cc(9,"Text: "),c.Sb(),c.Cc(10),c.Sb(),c.Tb(11,"p",30),c.Tb(12,"em"),c.Cc(13,"Date: "),c.Sb(),c.Cc(14),c.gc(15,"date"),c.Sb(),c.Sb(),c.Tb(16,"mat-dialog-actions",31),c.Tb(17,"button",32),c.Cc(18,"Cancel"),c.Sb(),c.Tb(19,"button",27),c.bc("click",(function(){return c.tc(e),c.fc().dialogRef.close("OK")})),c.Cc(20,"OK"),c.Sb(),c.Sb()}if(2&e){const e=t.$implicit,n=c.fc();c.Cb(1),c.Dc(n.dialogTitle),c.Cb(5),c.Dc(e.author.authorName),c.Cb(4),c.Dc(e.text),c.Cb(4),c.Dc(c.ic(15,4,1e3*e.date.seconds,"yyyy-MM-dd , hh:mm"))}}function Ue(e,t){1&e&&(c.Tb(0,"h1"),c.Cc(1,"Loading comments..."),c.Sb())}let De=(()=>{class e{constructor(e,t,n,o,i,r,a,c){this.activatedRoute=e,this.router=t,this.questionService=n,this.commentsService=o,this.auth=i,this.dialog=r,this._matSnakBar=a,this.spinnerService=c,this.questionId="",this.authorId="",this.dialogTitle="",this.userMessage=new s(this._matSnakBar)}ngOnInit(){this.activatedRoute.params.subscribe(e=>{this.questionId=e.uid,this.currentQuestion$=this.questionService.getQuestionById(e.uid),this.currentUser$=this.auth.checkUser().pipe(Object(w.a)(e=>{this.authorId=e.uid,this.mUser=e})),this.comments$=this.commentsService.getCommentsForQuestion(this.questionId)})}handleAddComment(e,t){e.uid=this.questionId,this.dialog.open(he,{data:{q:e,u:t},minWidth:"300px",width:"50%",hasBackdrop:!0})}handleApprove(e,t){this.dialogTitle=`Approve this question: "${e.title}"?`,this.dialogRef=this.dialog.open(t,{data:e}),this.dialogRef.afterClosed().pipe(Object(de.a)(e=>"OK"===e),Object(v.a)(t=>(this.spinnerService.showSpinner(),e.uid=this.questionId,e.onModeration=!1,this.questionService.updateQuestion(e)))).subscribe(()=>{this.spinnerService.hideSpinner(),this.userMessage.showMsg(`You approved this question: ${e.title}`)},e=>{this.spinnerService.hideSpinner(),this.userMessage.showMsg(`Something goes wrong!: ${e.message}`,"Error")},()=>{this.spinnerService.hideSpinner()})}handleDelete(e,t){this.dialogTitle=`Do you want to delete this question: "${e.title}"?`,this.dialogRef=this.dialog.open(t,{data:e}),this.dialogRef.afterClosed().pipe(Object(de.a)(e=>"OK"===e),Object(v.a)(e=>(this.spinnerService.showSpinner(),this.questionService.deleteQuestion(this.questionId)))).subscribe(()=>{this.spinnerService.hideSpinner(),this.userMessage.showMsg(`You delete this question: ${e.title}`),this.router.navigate(["content","questions"])},e=>{this.spinnerService.hideSpinner(),this.userMessage.showMsg(`Something goes wrong!: ${e.message}`,"Error")},()=>{this.spinnerService.hideSpinner()})}handleCommentMark(e,t,n){this.dialogTitle="Mark as solution?",this.dialogRef=this.dialog.open(n,{data:e}),this.dialogRef.afterClosed().pipe(Object(de.a)(e=>"OK"===e),Object(v.a)(n=>{t.uid=this.questionId,t.isResolved=!0,e.isSolution=!0,this.spinnerService.showSpinner();const o=this.questionService.updateQuestion(t),i=this.commentsService.updateComment(e);return Object(le.a)(o,i)})).subscribe(()=>{this.spinnerService.hideSpinner(),this.userMessage.showMsg("Your question marked as resolved!")},e=>{this.spinnerService.hideSpinner(),this.userMessage.showMsg(`Something goes wrong!: ${e.message}`,"Error")},()=>{this.spinnerService.hideSpinner()})}handleDeleteComment(e,t,n){this.dialogTitle="Delete this comment?",this.dialogRef=this.dialog.open(n,{data:e}),this.dialogRef.afterClosed().pipe(Object(de.a)(e=>"OK"===e),Object(v.a)(n=>{if(this.spinnerService.showSpinner(),!e.isSolution)return this.commentsService.deleteComment(e);t.uid=this.questionId,t.isResolved=!1;const o=this.questionService.updateQuestion(t),i=this.commentsService.deleteComment(e);return Object(le.a)(o,i)})).subscribe(()=>{this.spinnerService.hideSpinner(),this.userMessage.showMsg("You successfully delete comment")},e=>{this.spinnerService.hideSpinner(),this.userMessage.showMsg(`Something goes wrong!: ${e.message}`,"Error")},()=>{this.spinnerService.hideSpinner()})}handleEditQuestion(e,t){e.uid=this.questionId,this.dialog.open(we,{data:{q:e,u:t},width:"100%",hasBackdrop:!0})}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(u.a),c.Ob(u.b),c.Ob(M),c.Ob(be),c.Ob(l.a),c.Ob(ue.b),c.Ob(te.a),c.Ob(ne.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-selected-question-page"]],decls:6,vars:3,consts:[[4,"ngIf"],["YesNoDialog",""],["loadingBlock",""],[1,"question-section-wrapper"],[1,"question-toolbar-header"],[1,"question-text"],[1,"question-footer"],["color","primary",4,"ngFor","ngForOf"],["class","footer-control question-footer-btns",4,"ngIf"],["class","comment-wrapper",4,"ngIf","ngIfElse"],["color","primary"],[1,"footer-control","question-footer-btns"],["mat-flat-button","","color","accent",1,"question-btn",3,"click"],["class","question-btn","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["class","question-btn","mat-flat-button","","color","accent",3,"click",4,"ngIf"],["class","question-btn","mat-flat-button","","color","warn",3,"click",4,"ngIf"],["mat-flat-button","","color","primary",1,"question-btn",3,"click"],["mat-flat-button","","color","warn",1,"question-btn",3,"click"],[1,"comment-wrapper"],["class","comment",4,"ngFor","ngForOf"],[1,"comment"],[1,"comment-author"],[3,"src","alt"],[1,"comment-text"],[1,"controls-wrapper"],["mat-flat-button","","color","warn",3,"click",4,"ngIf"],["mat-fab","","color","accent",3,"click"],["mat-flat-button","","color","warn",3,"click"],[1,"checked-icon"],["matDialogTitle",""],[1,"yes-no-content"],["align","end"],["mat-flat-button","","mat-dialog-close","","color","primary"]],template:function(e,t){1&e&&(c.Ac(0,_e,19,15,"div",0),c.gc(1,"async"),c.Ac(2,Ae,21,7,"ng-template",null,1,c.Bc),c.Ac(4,Ue,2,0,"ng-template",null,2,c.Bc)),2&e&&c.mc("ngIf",c.hc(1,1,t.currentQuestion$))},directives:[o.l,R.b,o.k,R.a,_.a,A.a,ue.h,ue.e,ue.c,ue.d],pipes:[o.b,o.e],styles:["[_nghost-%COMP%]{width:100%;color:#673ab7}.question-section-wrapper[_ngcontent-%COMP%]{width:100%;margin-top:1rem;padding:2rem 1.5rem;outline:.2rem solid rgba(103,58,183,.2);outline-offset:5px;background:#fff}.question-toolbar-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap}h1[_ngcontent-%COMP%]{text-align:center;text-transform:capitalize;font-weight:700;padding-bottom:1rem;border-bottom:.1rem solid #673ab7}h3[_ngcontent-%COMP%]{font-weight:600;font-style:italic}.question-text[_ngcontent-%COMP%]{padding-top:1rem;text-align:left;font-size:18px}.question-footer[_ngcontent-%COMP%]{width:100%;display:flex;align-items:flex-start;justify-content:space-between}.question-footer-btns[_ngcontent-%COMP%]{flex:0 1 70%;text-align:right}.question-btn[_ngcontent-%COMP%]{min-width:80px;margin-left:5px}.comment-wrapper[_ngcontent-%COMP%]{width:100%;margin-top:1rem;padding:2rem 1.5rem;outline:.2rem solid rgba(103,58,183,.2);outline-offset:5px;background:rgba(103,58,183,.2)}.comment-wrapper[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:900;text-align:left;text-transform:capitalize;display:flex;flex-direction:column;color:#fff;border-bottom:.1rem solid #fff}.comment[_ngcontent-%COMP%]{width:100%;padding:1rem;margin-top:.5rem;display:flex;flex-wrap:wrap;align-items:flex-start;justify-content:flex-start;background:#fff;box-sizing:border-box}.comment-author[_ngcontent-%COMP%]{width:150px;position:relative}.comment-author[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.comment-author[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:2px 5px;position:absolute;bottom:0;left:50%;background:#ff0;color:purple;transform:translate(-50%);width:100%;text-align:center}.comment-text[_ngcontent-%COMP%]{flex:0 1 70%;padding:0 .5rem;text-align:center;font-size:18px}.comment-text[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-weight:700}.controls-wrapper[_ngcontent-%COMP%]{flex:0 1 10%}mat-icon.checked-icon[_ngcontent-%COMP%]{height:72px;width:72px;color:#28a745;font-size:72px}@media screen and (max-width:992px){.comment-text[_ngcontent-%COMP%]{flex:0 1 50%}}@media screen and (max-width:768px){.comment[_ngcontent-%COMP%]{flex-direction:column;align-items:center;justify-content:center}.comment-text[_ngcontent-%COMP%]{margin:1rem 0}}"]}),e})();var Ne=n("UbJi");let Re=(()=>{class e{constructor(e,t){this.db=e,this.afAuth=t}getAllUsers(){return this.db.collection("users").snapshotChanges().pipe(Object(T.a)(e=>e.map(e=>{const t=e.payload.doc.data();return Object.assign({uid:e.payload.doc.id},t)})))}updateUserProfileInfo(e,t){return Object(d.a)(this,void 0,void 0,(function*(){try{let n=yield this.afAuth.currentUser;return e.uid===n.uid&&(t&&(yield n.updatePassword(t)),yield n.updateProfile({displayName:e.displayName,photoURL:e.photoURL})),yield this.db.doc(`users/${e.uid}`).update(e),e}catch(n){throw new Error(n)}}))}}return e.\u0275fac=function(t){return new(t||e)(c.Xb(O.a),c.Xb(Ne.a))},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac}),e})();var je=n("/1cH");function Fe(e,t){1&e&&(c.Tb(0,"mat-error"),c.Cc(1,"Enter NickName!"),c.Sb())}function $e(e,t){1&e&&(c.Tb(0,"mat-error"),c.Cc(1,"Enter correct URL!"),c.Sb())}function Be(e,t){1&e&&(c.Tb(0,"mat-error"),c.Cc(1,"Password to short!"),c.Sb())}function Ee(e,t){if(1&e&&(c.Tb(0,"mat-option",27),c.Cc(1),c.Sb()),2&e){const e=t.$implicit;c.mc("value",e.email||e.displayName)("id",e.uid),c.Cb(1),c.Ec(" ",e.email||e.displayName," ")}}function Le(e,t){if(1&e){const e=c.Ub();c.Tb(0,"mat-form-field",21),c.Tb(1,"input",22,23),c.bc("keypress",(function(){c.tc(e);const t=c.sc(2);return c.fc(3).filterUsers(t.value)})),c.Sb(),c.Tb(3,"mat-autocomplete",24,25),c.bc("optionSelected",(function(t){return c.tc(e),c.fc(3).displayRoles(t)})),c.Ac(5,Ee,2,3,"mat-option",26),c.Sb(),c.Sb()}if(2&e){const e=c.sc(4),t=c.fc(3);c.Cb(1),c.mc("matAutocomplete",e),c.Cb(4),c.mc("ngForOf",t.filteredList)}}function Qe(e,t){if(1&e){const e=c.Ub();c.Tb(0,"div"),c.Tb(1,"mat-checkbox",28,29),c.bc("change",(function(){c.tc(e);const t=c.sc(2);return c.fc(3).selectedUser.roles.admin=t.checked})),c.Cc(3,"Admin"),c.Sb(),c.Tb(4,"mat-checkbox",28,30),c.bc("change",(function(){c.tc(e);const t=c.sc(5);return c.fc(3).selectedUser.roles.guest=t.checked})),c.Cc(6,"Guest"),c.Sb(),c.Sb()}if(2&e){const e=c.fc(3);c.Cb(1),c.mc("checked",e.selectedUser.roles.admin),c.Cb(3),c.mc("checked",e.selectedUser.roles.guest)}}function Ge(e,t){if(1&e){const e=c.Ub();c.Tb(0,"div",10),c.Tb(1,"mat-expansion-panel",11),c.Tb(2,"mat-expansion-panel-header"),c.Tb(3,"mat-panel-title"),c.Cc(4," Change Password "),c.Sb(),c.Tb(5,"mat-panel-description"),c.Tb(6,"mat-checkbox",null,18),c.Cc(8,"Change"),c.Sb(),c.Sb(),c.Sb(),c.Tb(9,"div",19),c.Ac(10,Le,6,2,"mat-form-field",20),c.Ac(11,Qe,7,2,"div",8),c.Sb(),c.Tb(12,"div",10),c.Tb(13,"button",16),c.bc("click",(function(){return c.tc(e),c.fc(2).updateUserRole()})),c.Cc(14,"Update Roles"),c.Sb(),c.Sb(),c.Sb(),c.Sb()}if(2&e){const e=c.sc(7),t=c.fc(2);c.Cb(1),c.mc("disabled",!e.checked)("expanded",e.checked)("hideToggle",!0),c.Cb(9),c.mc("ngIf",t.filteredList.length>0),c.Cb(1),c.mc("ngIf",t.showRole),c.Cb(2),c.mc("disabled",!t.selectedUser)}}function ze(e,t){if(1&e){const e=c.Ub();c.Tb(0,"div",2),c.Tb(1,"div",3),c.Pb(2,"img",4),c.Tb(3,"span"),c.Cc(4),c.Sb(),c.Sb(),c.Tb(5,"div",5),c.Tb(6,"mat-form-field",6),c.Tb(7,"mat-label"),c.Cc(8,"Nickname"),c.Sb(),c.Pb(9,"input",7),c.Ac(10,Fe,2,0,"mat-error",8),c.Sb(),c.Tb(11,"mat-form-field",6),c.Tb(12,"mat-label"),c.Cc(13,"Photo Reference"),c.Sb(),c.Pb(14,"input",9),c.Ac(15,$e,2,0,"mat-error",8),c.Sb(),c.Tb(16,"div",10),c.Tb(17,"mat-expansion-panel",11),c.Tb(18,"mat-expansion-panel-header"),c.Tb(19,"mat-panel-title"),c.Cc(20," Change Password "),c.Sb(),c.Tb(21,"mat-panel-description"),c.Tb(22,"mat-checkbox",12,13),c.bc("change",(function(){c.tc(e);const t=c.sc(23),n=c.fc();return t.checked?null:n.form.get("userPassword").setValue("")})),c.Cc(24,"Change"),c.Sb(),c.Sb(),c.Sb(),c.Tb(25,"mat-form-field",14),c.Tb(26,"mat-label"),c.Cc(27,"Your password"),c.Sb(),c.Pb(28,"input",15),c.Ac(29,Be,2,0,"mat-error",8),c.Sb(),c.Sb(),c.Sb(),c.Tb(30,"div",10),c.Tb(31,"button",16),c.bc("click",(function(){c.tc(e);const n=t.ngIf;return c.fc().updateCurrentUser(n)})),c.Cc(32,"Update"),c.Sb(),c.Sb(),c.Ac(33,Ge,15,6,"div",17),c.Sb(),c.Sb()}if(2&e){const e=t.ngIf,n=c.sc(23),o=c.fc();c.Cb(2),c.nc("src",e.photoURL,c.vc),c.nc("alt",e.displayName?e.displayName:e.email),c.Cb(2),c.Dc(e.displayName),c.Cb(1),c.mc("formGroup",o.form),c.Cb(4),c.nc("value",e.displayName),c.Cb(1),c.mc("ngIf",o.form.get("nickName").invalid),c.Cb(4),c.nc("value",e.photoURL),c.Cb(1),c.mc("ngIf",o.form.get("photoUrl").invalid),c.Cb(2),c.mc("disabled",!n.checked)("expanded",n.checked)("hideToggle",!0),c.Cb(12),c.mc("ngIf",o.form.get("userPassword").hasError("minlength")),c.Cb(2),c.mc("disabled",o.form.invalid),c.Cb(2),c.mc("ngIf",e.roles.admin)}}function Je(e,t){1&e&&(c.Tb(0,"h1"),c.Cc(1,"Loading data ..."),c.Sb())}let Ye=(()=>{class e{constructor(e,t,n,o){this.authService=e,this._snackBar=t,this.spinnerService=n,this.userInfoService=o,this.userList=[],this.filteredList=[],this.showRole=!1,this.showUserMsg=new s(this._snackBar)}ngOnInit(){this.userInfoService.getAllUsers().subscribe(e=>{this.userList=[...e],this.filteredList=[...this.userList]}),this.user$=this.authService.checkUser().pipe(Object(w.a)(e=>this.initForm(e)))}initForm(e){this.form=new a.e({nickName:new a.c(e.displayName,[a.q.required]),photoUrl:new a.c(e.photoURL,[a.q.required,a.q.pattern("https?://.+")]),userPassword:new a.c(null,[a.q.minLength(6)])})}updateCurrentUser(e){return Object(d.a)(this,void 0,void 0,(function*(){if(this.form.invalid)return;let t=this.form.value.userPassword,n={uid:e.uid,roles:e.roles,photoURL:this.form.value.photoUrl,displayName:this.form.value.nickName,email:e.email,emailVerified:e.emailVerified};try{this.spinnerService.showSpinner();let e=yield t?this.userInfoService.updateUserProfileInfo(n,t):this.userInfoService.updateUserProfileInfo(n);this.showUserMsg.showMsg(`User: ${e.displayName} / ${e.email} info was updated!`)}catch(o){this.showUserMsg.showMsg(`Error: ${o.message}`,"Error")}finally{this.spinnerService.hideSpinner()}}))}updateUserRole(){return Object(d.a)(this,void 0,void 0,(function*(){if(this.selectedUser)try{this.spinnerService.showSpinner();let e=yield this.userInfoService.updateUserProfileInfo(this.selectedUser);this.showUserMsg.showMsg(`User: ${e.displayName} / ${e.email} ROLES was updated!`)}catch(e){this.showUserMsg.showMsg(`Error: ${e.message}`,"Error")}finally{this.spinnerService.hideSpinner()}}))}filterUsers(e){this.showRole=!1;const t=e.trim().toLowerCase();this.filteredList=this.userList.filter(e=>{let n=!1,o=!1;return e.email&&(n=e.email.toLowerCase().trim().includes(t)),e.displayName&&(o=e.displayName.toLowerCase().trim().includes(t)),n||o})}displayRoles(e){this.selectedUser=this.userList.find(t=>t.uid===e.option.id),this.showRole=!0}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(l.a),c.Ob(te.a),c.Ob(ne.a),c.Ob(Re))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-profile-page"]],decls:4,vars:4,consts:[["class","profile-wrapper",4,"ngIf","ngIfElse"],["loadingBlock",""],[1,"profile-wrapper"],[1,"info-wrapper"],[3,"src","alt"],[1,"form-wrapper",3,"formGroup"],["appearance","outline",1,"form-element-wrapper"],["matInput","","formControlName","nickName",3,"value"],[4,"ngIf"],["matInput","","type","url","formControlName","photoUrl",3,"value"],[1,"form-element-wrapper"],[3,"disabled","expanded","hideToggle"],[3,"change"],["changePassword",""],["appearance","outline"],["matInput","","type","password","formControlName","userPassword"],["mat-flat-button","","color","accent",3,"disabled","click"],["class","form-element-wrapper",4,"ngIf"],["changeRole",""],[1,"roles-controls-wrapper"],["appearance","outline","class","example-full-width",4,"ngIf"],["appearance","outline",1,"example-full-width"],["type","text","placeholder","Pick one","aria-label","Number","matInput","",3,"matAutocomplete","keypress"],["search",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value","id",4,"ngFor","ngForOf"],[3,"value","id"],[3,"checked","change"],["AdChk",""],["GsChk",""]],template:function(e,t){if(1&e&&(c.Ac(0,ze,34,14,"div",0),c.gc(1,"async"),c.Ac(2,Je,2,0,"ng-template",null,1,c.Bc)),2&e){const e=c.sc(3);c.mc("ngIf",c.hc(1,2,t.user$))("ngIfElse",e)}},directives:[o.l,a.l,a.f,q.c,q.f,N.a,a.b,a.k,a.d,x.c,x.e,x.f,x.d,I.a,_.a,q.b,je.c,je.a,o.k,P.i],pipes:[o.b],styles:["[_nghost-%COMP%]{width:100%;margin-top:2rem}.profile-wrapper[_ngcontent-%COMP%]{width:100%;border:.1rem solid #ffd740;background:#fff;padding:1.5rem 1rem;display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap}.info-wrapper[_ngcontent-%COMP%]{flex:0 1 35%;position:relative}.info-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:auto}.info-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;width:100%;text-align:center;position:absolute;bottom:0;left:0;padding:3px 6px;background:#673ab7;color:#fff}.form-wrapper[_ngcontent-%COMP%]{flex:0 1 60%;display:flex;flex-direction:column}.form-element-wrapper[_ngcontent-%COMP%]{width:100%;margin-bottom:1.2rem;padding:0}.form-element-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:block;margin:0 auto}.roles-controls-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:space-between}@media screen and (max-width:768px){.info-wrapper[_ngcontent-%COMP%]{flex:0 1 100%}.form-wrapper[_ngcontent-%COMP%]{margin-top:1rem;flex:0 1 100%}}"]}),e})(),Ke=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},providers:[M,be,Re],imports:[[o.c,ee.a,u.e.forChild([{path:"",redirectTo:"/content/questions",pathMatch:"full"},{path:"questions",component:Z},{path:"questions/create",component:ce,pathMatch:"full"},{path:"question/:uid",component:De,pathMatch:"full"},{path:"profile",component:Ye}])]]}),e})()}}]);